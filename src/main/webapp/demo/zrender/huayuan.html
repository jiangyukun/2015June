<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>ZRender</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ZRender">
    <meta name="author" content="kener.linfeng@gmail.com">

    <script src="doc/asset/js/esl/esl.js"></script>

    <link href="doc/asset/css/zrenderHome.css" rel="stylesheet">
</head>

<body>
<div class="face" id='face' style="height:500px;"></div>
<button id="btn">CLICK</button>

<script src="doc/asset/js/jquery.js"></script>
<script>
    var zr; // 全局可用zrender对象
    var animationTicket;
    var developMode = false;
    if (developMode) {
        // for develop
        require.config({
            packages: [
                {
                    name: 'zrender',
                    location: 'src',
                    main: 'zrender'
                }
            ]
        });
    }
    else {
        // for echarts online home page
        var fileLocation = './doc/example/www/js/zrender';
        require.config({
            paths:{
                zrender: fileLocation,
                'zrender/shape/Rose': fileLocation,
                'zrender/shape/Trochoid': fileLocation,
                'zrender/shape/Circle': fileLocation,
                'zrender/shape/Sector': fileLocation,
                'zrender/shape/Ring': fileLocation,
                'zrender/shape/Ellipse': fileLocation,
                'zrender/shape/Rectangle': fileLocation,
                'zrender/shape/Text': fileLocation,
                'zrender/shape/Heart': fileLocation,
                'zrender/shape/Droplet': fileLocation,
                'zrender/shape/Line': fileLocation,
                'zrender/shape/Image': fileLocation,
                'zrender/shape/Star': fileLocation,
                'zrender/shape/Isogon': fileLocation,
                'zrender/shape/BezierCurve': fileLocation,
                'zrender/shape/Polyline': fileLocation,
                'zrender/shape/Path': fileLocation,
                'zrender/shape/Polygon': fileLocation
            }
        });
    }

    require(
            [
                'zrender',
                'zrender/shape/Line',
                'zrender/shape/Circle',
                'zrender/shape/Rectangle'
            ],
            function (zrender,LineShape,CircleShape) {
                var zr = zrender.init(document.getElementById('face'));
                var color = require('zrender/tool/color');
                var colorIdx = 0;
                var width = Math.ceil(zr.getWidth());
                var height = Math.ceil(zr.getHeight());
                var n=12,A=2*Math.PI/n,r=150;//n=1+Math.round(99*Math.random())//1~100

                var lines={},fCricles={};
                var myCircle=new CircleShape({
                    zlevel : 1,
                    style : {
                        x : 210,
                        y : height/2,
                        r : 20,
                        brushType : 'both',
                        color : 'rgba(255, 69, 0, 1)',
                        strokeColor : 'rgba(255, 255, 255, 1)',
                        lineWidth : 8,
                        shadowBlur: 20,
                        shadowColor : 'rgba(255,215,0,0.8)',
                        text : 'me',
                        textPosition : 'inside',
                        textFont : 'normal 18px 微软雅黑',
                        textAlign : 'center'
                    },
                    clickable : true,
                    onclick : function(){
                        //alert( 'doc/example/demo.html')
                    }
                });var btn=document.getElementById("btn").onclick=Click;
                //提示框
                var Rectangle = require('zrender/shape/Rectangle');
                var shape = new Rectangle({
                    style: {
                        x: 210+r*1.5,
                        y: height/2-75,
                        width: 150,
                        height: 150,
                        radius: 5,
                        text:'這是提示信息！！！',
                        textPosition:'inside',
                        textFont:'normal 15px 微软雅黑',
                        textAlign:'center'
                    }
                });
                zr.addShape(shape);
                for(var i=0;i<n;i++){
                    lines[i]=new LineShape({
                        rotation:[0,210,height/2],
                        style : {
                            xStart : 210,
                            yStart : height/2,
                            xEnd : 210+r*Math.cos(A*i),
                            yEnd : height/2+r*Math.sin(A*i),
                            strokeColor : color.getColor(colorIdx++),
                            lineWidth : 2,
                            lineType : 'solid',    // default solid
                            text : ''
                        },
                        hoverable:false
                    });

                    fCricles[i]=new CircleShape({
                        zlevel : 1,
                        rotation:[0,210,height/2],
                        style : {
                            x : 210+r*Math.cos(A*i),
                            y : height/2+r*Math.sin(A*i),
                            r : circleChange(n),
                            brushType : 'both',
                            color : 'rgba(255, 69, 0, 1)',
                            strokeColor : color.getColor(colorIdx++),//'rgba(255, 255, 255, 1)',
                            lineWidth : 8,
                            shadowBlur: 20,
                            shadowColor : 'rgba(255,215,0,0.8)',
                            text : i+1,
                            textPosition : 'inside',
                            textFont : 'normal '+fontSizeChange(n)+' 微软雅黑',
                            textAlign : 'center'
                        },
                        clickable : true,
                        onclick : function(){

                        }
                    });
                }

                zr.addShape(myCircle);
                for(var i=0;i<n;i++){
                    zr.addShape(lines[i]);
                    zr.addShape(fCricles[i]);
                }

                zr.render();
                var num=0;
                function Click(y){
                    if(y>0){
                        num--;
                        //if(num===0) num--;
                    }else{
                        num++;
                        //if(num===0) num++;
                    }
                    for(var i=0;i<n;i++){
                        zr.animate(fCricles[i].id)  //(fCricles[i].id,'',true)
                                .when(1000*timeChange(n), {
                                    rotation:[num*A,210,height/2]
                                })
                                .start();
                        zr.animate(lines[i].id)
                                .when(1000*timeChange(n), {
                                    rotation:[num*A,210,height/2]
                                })
                                .start();
                    }

                }
                //圓半徑r變化
                function circleChange(n){
                    if(n<20){
                        return 20;
                    }else if(n<40){
                        return 10;
                    }else if(n<60){
                        return 5;
                    }else if(n<80){
                        return 2;
                    }else if(n<100){
                        return 1;
                    }
                }
                //fontSize變化
                function fontSizeChange(n){
                    if(n<20){
                        return '18px';
                    }else if(n<40){
                        return '16px';
                    }else if(n<60){
                        return '14px';
                    }else if(n<80){
                        return '12px';
                    }else if(n<100){
                        return '10px';
                    }
                }
                //time變化
                function timeChange(n){
                    if(n<20){
                        return 1;
                    }else if(n<40){
                        return 0.8;
                    }else if(n<60){
                        return 0.5;
                    }else if(n<80){
                        return 0.1;
                    }else if(n<100){
                        return 0.05;
                    }
                }

                var body=document.getElementsByTagName("body")[0];
                body.addEventListener("touchstart", touchStart, false);
                body.addEventListener("touchmove", touchMove, false);
                body.addEventListener("touchend", touchEnd, false);
                var startX,startY,moveX,moveY;

                function touchStart(event) {
                    event.preventDefault();
                    if (!event.touches.length) return;
                    var touch = event.touches[0];
                    startX = touch.pageX;
                    startY = touch.pageY;
                }

                function touchMove(event) {
                    event.preventDefault();
                    if (!event.touches.length) return;
                    var touch = event.touches[0],
                            x = touch.pageX - startX,
                            y = touch.pageY - startY;
                    if (Math.abs(x) < Math.abs(y)) {
                        //Click(y);
                    }
                    moveX=x;moveY=y;
                }

                function touchEnd(event) {
                    if (Math.abs(moveX) < Math.abs(moveY)) {
                        Click(moveY);
                    }
                }
            }
    );
</script>
</body>
</html>
